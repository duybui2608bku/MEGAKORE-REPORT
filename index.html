<!DOCTYPE html>
<html lang="vi">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Megakorea - Báo Cáo Telesales</title>

      <!-- Modern UI Libraries -->
      <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet" />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
      <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.40.0/apexcharts.min.js"></script>
      <style>
         @import url("https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap");

         :root {
            --primary: #4f46e5;
            --primary-dark: #4338ca;
            --secondary: #0ea5e9;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --light: #f8fafc;
            --dark: #1e293b;
            --gold: #ffc107;
            --silver: #94a3b8;
            --bronze: #b45309;
            --gradient-primary: linear-gradient(135deg, #4f46e5, #3b82f6);
            --gradient-secondary: linear-gradient(135deg, #0ea5e9, #06b6d4);
            --gradient-gold: linear-gradient(135deg, #fbbf24, #f59e0b);
            --gradient-silver: linear-gradient(135deg, #cbd5e1, #94a3b8);
            --gradient-bronze: linear-gradient(135deg, #d97706, #b45309);
         }

         * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Montserrat", sans-serif;
         }

         body {
            background-color: #f1f5f9;
            color: var(--dark);
            line-height: 1.5;
            height: 100vh;
            overflow: hidden;
         }

         /* Dashboard header styles */
         .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--gradient-primary);
            padding: 0.5rem 1.5rem;
            border-radius: 12px;
            color: white;
            box-shadow: 0 10px 25px -5px rgba(79, 70, 229, 0.3);
            margin-bottom: 0.75rem;
            height: 35px;
            position: relative;
            overflow: hidden;
         }

         .dashboard-header::before {
            content: "";
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            opacity: 0.5;
            animation: rotate 30s linear infinite;
         }

         @keyframes rotate {
            0% {
               transform: rotate(0deg);
            }
            100% {
               transform: rotate(360deg);
            }
         }

         .dashboard-title {
            font-size: 1.15rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            position: relative;
            z-index: 1;
         }

         .dashboard-title i {
            font-size: 1.25rem;
         }

         .dashboard-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            position: relative;
            z-index: 1;
         }

         .date-display {
            font-size: 0.775rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.15);
            padding: 0.375rem 0.75rem;
            border-radius: 20px;
         }

         .refresh-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.775rem;
            background: rgba(255, 255, 255, 0.15);
            padding: 0.375rem 0.75rem;
            border-radius: 20px;
         }

         /* KPI cards */
         .kpi-section {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 0.75rem;
         }

         .kpi-card {
            background: white;
            border-radius: 12px;
            padding: 0.75rem;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
         }

         .kpi-card i {
            font-size: 1.5rem;
            margin-right: 0.75rem;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
         }

         .kpi-content {
            flex: 1;
         }

         .kpi-title {
            font-size: 0.75rem;
            color: #64748b;
            margin-bottom: 0.25rem;
         }

         .kpi-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-dark);
         }

         /* Sections */
         .container-fluid {
            padding: 0 1rem;
            max-height: calc(100vh - 2rem);
         }

         .section-title {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
         }

         .section-title i {
            color: var(--primary);
         }

         /* Chart section */
         .chart-section {
            background: white;
            border-radius: 12px;
            padding: 0.75rem;
            margin-bottom: 0.75rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
         }

         .chart-container {
            height: 200px;
         }

         /* Staff grid - compact 7 cards in a row */
         .staff-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 0.75rem;
         }

         .staff-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            height: 100%;
            transition: all 0.2s ease;
         }

         .staff-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
         }

         .staff-header {
            padding: 0.5rem;
            background: var(--gradient-primary);
            color: white;
            text-align: center;
            position: relative;
         }

         .staff-avatar {
            width: 40px;
            height: 40px;
            margin: 0 auto 0.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
            color: var(--primary-dark);
            border-radius: 50%;
            background: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
         }

         .staff-avatar.gold {
            color: #b45309;
            background: var(--gold);
            box-shadow: 0 0 10px rgba(251, 191, 36, 0.5);
         }

         .staff-avatar.silver {
            color: #475569;
            background: #e2e8f0;
            box-shadow: 0 0 10px rgba(203, 213, 225, 0.5);
         }

         .staff-avatar.bronze {
            color: #823500;
            background: #fdba74;
            box-shadow: 0 0 10px rgba(251, 146, 60, 0.5);
         }

         .staff-name {
            font-size: 0.875rem;
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 0.25rem;
         }

         .staff-rank {
            position: absolute;
            top: 0.25rem;
            right: 0.25rem;
            font-size: 0.75rem;
            font-weight: 600;
            padding: 0.125rem 0.375rem;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.25);
         }

         .staff-body {
            padding: 0.5rem;
            flex: 1;
            display: flex;
            flex-direction: column;
         }

         .staff-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.5rem;
            text-align: center;
            margin-bottom: 0.5rem;
         }

         .stat-item {
            padding: 0.25rem;
         }

         .stat-value {
            font-size: 1.125rem;
            font-weight: 700;
            color: var(--primary-dark);
         }

         .stat-label {
            font-size: 0.625rem;
            color: #64748b;
         }

         .progress-section {
            margin-bottom: 0.375rem;
         }

         .progress-title {
            display: flex;
            justify-content: space-between;
            font-size: 0.7rem;
            margin-bottom: 0.125rem;
         }

         .progress-label {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            display: flex;
            align-items: center;
            gap: 0.25rem;
         }

         .progress-value {
            font-weight: 600;
         }

         .progress-bar {
            height: 5px;
            background-color: #e2e8f0;
            border-radius: 3px;
            overflow: hidden;
         }

         .progress {
            height: 100%;
            border-radius: 3px;
         }

         .progress-success {
            background: var(--success);
         }

         .progress-warning {
            background: var(--warning);
         }

         .progress-info {
            background: var(--secondary);
         }

         /* Animation for accent */
         .animation-pulse {
            animation: pulse 2s infinite;
         }

         @keyframes pulse {
            0% {
               opacity: 1;
            }
            50% {
               opacity: 0.5;
            }
            100% {
               opacity: 1;
            }
         }

         /* Award screen styles */
         .award-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.5s ease;
         }

         .award-screen.active {
            opacity: 1;
            pointer-events: auto;
         }

         .award-header {
            text-align: center;
            margin-bottom: 2rem;
            animation: fadeInDown 1s;
         }

         .award-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            text-shadow: 0 0 20px rgba(79, 70, 229, 0.5);
            background: linear-gradient(to right, #fff, #93c5fd);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
         }

         .award-subtitle {
            font-size: 1.25rem;
            color: #93c5fd;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px rgba(147, 197, 253, 0.5);
         }

         .award-winners {
            display: flex;
            justify-content: center;
            gap: 2rem;
            animation: fadeIn 1s;
         }

         .award-winner {
            text-align: center;
            animation: floatAnimation 4s ease-in-out infinite;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            padding: 1.5rem;
            border-radius: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            width: 220px;
            position: relative;
            overflow: hidden;
         }

         .award-winner:nth-child(2) {
            animation-delay: 0.5s;
         }

         .award-winner:nth-child(3) {
            animation-delay: 1s;
         }

         .medal {
            font-size: 3rem;
            margin-bottom: 0.75rem;
            animation: shine 2s infinite;
         }

         .winner-rank {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
            z-index: 2;
         }

         .rank-1 {
            background: var(--gradient-gold);
            box-shadow: 0 0 15px rgba(255, 193, 7, 0.5);
         }

         .rank-2 {
            background: var(--gradient-silver);
            box-shadow: 0 0 15px rgba(148, 163, 184, 0.5);
         }

         .rank-3 {
            background: var(--gradient-bronze);
            box-shadow: 0 0 15px rgba(180, 83, 9, 0.5);
         }

         .winner-avatar {
            width: 80px;
            height: 80px;
            margin: 0 auto 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 2rem;
            border-radius: 50%;
            background: white;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
         }

         .avatar-gold {
            color: #b45309;
            background: var(--gold);
            box-shadow: 0 0 20px rgba(251, 191, 36, 0.8);
         }

         .avatar-silver {
            color: #475569;
            background: #e2e8f0;
            box-shadow: 0 0 20px rgba(203, 213, 225, 0.8);
         }

         .avatar-bronze {
            color: #823500;
            background: #fdba74;
            box-shadow: 0 0 20px rgba(251, 146, 60, 0.8);
         }

         .winner-name {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
         }

         .winner-stats {
            font-size: 1rem;
            color: #93c5fd;
            margin-bottom: 0.5rem;
         }

         .winner-rate {
            font-size: 1.5rem;
            font-weight: 700;
            color: #fbbf24;
         }

         /* Stars animation */
         .stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
         }

         .star {
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            animation: twinkle var(--duration) infinite ease;
            opacity: var(--opacity);
         }

         /* Confetti animation */
         .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 0;
            animation: confetti-fall 5s ease-in-out infinite;
            z-index: 1;
         }

         .confetti.square {
            border-radius: 0;
         }

         .confetti.circle {
            border-radius: 50%;
         }

         .confetti.triangle {
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-bottom: 15px solid;
            background-color: transparent !important;
         }

         @keyframes confetti-fall {
            0% {
               transform: translateY(-100vh) rotate(0deg);
               opacity: 1;
            }
            100% {
               transform: translateY(100vh) rotate(720deg);
               opacity: 0;
            }
         }

         @keyframes twinkle {
            0% {
               opacity: var(--start-opacity);
            }
            50% {
               opacity: var(--end-opacity);
            }
            100% {
               opacity: var(--start-opacity);
            }
         }

         @keyframes fadeInDown {
            from {
               opacity: 0;
               transform: translateY(-50px);
            }
            to {
               opacity: 1;
               transform: translateY(0);
            }
         }

         @keyframes fadeIn {
            from {
               opacity: 0;
            }
            to {
               opacity: 1;
            }
         }

         @keyframes shine {
            0% {
               filter: brightness(1);
            }
            50% {
               filter: brightness(1.5);
            }
            100% {
               filter: brightness(1);
            }
         }

         @keyframes floatAnimation {
            0% {
               transform: translateY(0);
            }
            50% {
               transform: translateY(-10px);
            }
            100% {
               transform: translateY(0);
            }
         }

         .close-award {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
         }

         .close-award:hover {
            background: rgba(255, 255, 255, 0.3);
         }

         /* CSS cho màn hình vinh danh mới với 2 nhân viên */
         /* Animation classes */
         .animate__animated {
            animation-duration: 1s;
            animation-fill-mode: both;
         }

         .animate__fadeInLeft {
            animation-name: fadeInLeft;
         }

         .animate__fadeInRight {
            animation-name: fadeInRight;
         }

         @keyframes fadeInLeft {
            from {
               opacity: 0;
               transform: translate3d(-100%, 0, 0);
            }
            to {
               opacity: 1;
               transform: translate3d(0, 0, 0);
            }
         }

         @keyframes fadeInRight {
            from {
               opacity: 0;
               transform: translate3d(100%, 0, 0);
            }
            to {
               opacity: 1;
               transform: translate3d(0, 0, 0);
            }
         }

         /* Styles cho winner image */
         .winner-image {
            width: 120px;
            height: 120px;
            margin: 0 auto 1rem;
            border-radius: 50%;
            overflow: hidden;
            border: 4px solid white;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
         }

         .award-photo {
            width: 100%;
            height: 100%;
            object-fit: cover;
         }

         /* Styles cho star rating */
         .star-rating {
            margin-top: 10px;
            color: #ffc107;
            font-size: 1.2rem;
            letter-spacing: 3px;
         }

         /* Adjusted styles cho award winners */
         .award-winners {
            display: flex;
            justify-content: center;
            gap: 3rem;
            width: 100%;
            max-width: 800px;
         }

         .award-winner {
            text-align: center;
            animation: floatAnimation 4s ease-in-out infinite;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(5px);
            padding: 1.5rem;
            border-radius: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            width: 240px;
            position: relative;
            overflow: hidden;
         }

         /* Special effects for ranks */
         .rank-1 {
            background: var(--gradient-gold);
            box-shadow: 0 0 15px var(--gold);
         }

         .rank-2 {
            background: var(--gradient-silver);
            box-shadow: 0 0 15px var(--silver);
         }

         /* Effects cho award rank indicator */
         .winner-rank {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.25rem;
            z-index: 2;
         }

         /* Award Page Styles */
         .award-page {
            background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
            color: white;
            overflow: hidden;
         }

         #stars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
         }

         .award-container {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 2rem;
            position: relative;
            z-index: 10;
         }

         .award-header {
            text-align: center;
            margin-bottom: 3rem;
            position: relative;
            animation: fadeInDown 1s;
         }

         .award-title {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 0.75rem;
            text-shadow: 0 0 20px rgba(79, 70, 229, 0.5);
            background: linear-gradient(to right, #fff, #93c5fd);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
         }

         .award-title::after {
            content: "";
            position: absolute;
            width: 100px;
            height: 5px;
            background: linear-gradient(to right, #4f46e5, transparent);
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 3px;
         }

         .award-subtitle {
            font-size: 1.5rem;
            color: #93c5fd;
            margin-bottom: 1rem;
            text-shadow: 0 0 10px rgba(147, 197, 253, 0.5);
         }

         .award-date {
            font-size: 1rem;
            color: #cbd5e1;
         }

         .award-content {
            display: flex;
            justify-content: center;
            align-items: center;
            flex: 1;
            gap: 4rem;
            max-width: 1200px;
            margin: 0 auto;
         }

         .award-item {
            text-align: center;
            position: relative;
            transition: all 0.5s ease;
            animation: floatAnimation 4s ease-in-out infinite;
         }

         @keyframes floatAnimation {
            0% {
               transform: translateY(0);
            }
            50% {
               transform: translateY(-15px);
            }
            100% {
               transform: translateY(0);
            }
         }

         .award-item:nth-child(2) {
            animation-delay: 1s;
         }

         .award-photo-container {
            position: relative;
            width: 320px;
            height: 350px;
            margin-bottom: 2rem;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            transform: perspective(1000px) rotateY(0deg);
            transition: transform 0.5s ease;
         }

         .award-photo-container:hover {
            transform: perspective(1000px) rotateY(5deg);
         }

         .award-photo {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: all 0.5s ease;
         }

         .award-photo-container:hover .award-photo {
            transform: scale(1.05);
         }

         .award-photo-container::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(to bottom, rgba(0, 0, 0, 0.1) 0%, rgba(0, 0, 0, 0.3) 70%, rgba(0, 0, 0, 0.7) 100%);
            z-index: 1;
         }

         .award-photo-container::after {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 50%;
            height: 100%;
            background: linear-gradient(to right, transparent, rgba(255, 255, 255, 0.2), transparent);
            transform: skewX(-25deg);
            animation: shine 6s infinite;
         }

         .award-badge {
            position: absolute;
            top: -30px;
            right: -30px;
            width: 140px;
            height: 140px;
            z-index: 2;
         }

         .badge-gold {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'%3E%3Ccircle cx='70' cy='70' r='65' fill='%23FFCA28' stroke='%23FFA000' stroke-width='3'/%3E%3Ctext x='70' y='75' font-family='Arial' font-size='24' font-weight='bold' text-anchor='middle' fill='%23B71C1C'%3ETOP 1%3C/text%3E%3Cpath d='M70 15 L75 30 L90 30 L80 40 L85 55 L70 45 L55 55 L60 40 L50 30 L65 30 Z' fill='%23FFD54F'/%3E%3C/svg%3E");
         }

         .badge-silver {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'%3E%3Ccircle cx='70' cy='70' r='65' fill='%23E0E0E0' stroke='%23BDBDBD' stroke-width='3'/%3E%3Ctext x='70' y='75' font-family='Arial' font-size='24' font-weight='bold' text-anchor='middle' fill='%23424242'%3ETOP 2%3C/text%3E%3Cpath d='M70 15 L75 30 L90 30 L80 40 L85 55 L70 45 L55 55 L60 40 L50 30 L65 30 Z' fill='%23F5F5F5'/%3E%3C/svg%3E");
         }

         .award-employee-name {
            font-size: 1.75rem;
            font-weight: 700;
            color: white;
            position: absolute;
            bottom: 50px;
            left: 0;
            width: 100%;
            text-align: center;
            z-index: 3;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
         }

         .award-stats {
            font-size: 1.375rem;
            color: #93c5fd;
            margin-bottom: 0.75rem;
            text-shadow: 0 0 10px rgba(147, 197, 253, 0.5);
            position: relative;
            display: inline-block;
         }

         .award-stats::after {
            content: "";
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 3px;
            background: rgba(147, 197, 253, 0.5);
            border-radius: 3px;
         }

         .award-position {
            display: inline-block;
            font-size: 1.75rem;
            font-weight: 700;
            padding: 0.75rem 2rem;
            border-radius: 50px;
            margin-bottom: 1.5rem;
            position: relative;
            z-index: 1;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
         }

         .position-gold {
            background: var(--gradient-gold);
            color: #7c2d12;
         }

         .position-silver {
            background: var(--gradient-silver);
            color: #1f2937;
         }

         .star-rating {
            margin-top: 0.75rem;
            color: #fbbf24;
            font-size: 1.75rem;
            filter: drop-shadow(0 0 5px rgba(251, 191, 36, 0.5));
         }
      </style>
   </head>
   <body>
      <!-- Màn hình vinh danh -->
      <div id="awardScreen" class="award-screen">
         <div id="stars" class="stars"></div>
         <button class="close-award" onclick="hideAwardScreen()">
            <i class="fas fa-times"></i>
         </button>
         <div class="award-header">
            <h2 class="award-title">VINH DANH NHÂN VIÊN XUẤT SẮC</h2>
            <p class="award-subtitle">Telesales xuất sắc nhất tháng <span id="awardMonth">5/2025</span></p>
         </div>
         <div id="awardWinners" class="award-winners">
            <!-- Winners will be generated here -->
         </div>
      </div>

      <div class="container-fluid">
         <!-- Dashboard Header -->
         <header class="dashboard-header">
            <div class="dashboard-title">
               <i class="fas fa-chart-line"></i>
               <h1>Megakorea - Báo Cáo Telesales</h1>
            </div>
            <div class="dashboard-info">
               <div class="date-display">
                  <i class="far fa-calendar-alt"></i>
                  <span id="currentDate">Ngày 07/05/2025</span>
               </div>
               <div class="refresh-info">
                  <i class="fas fa-sync-alt animation-pulse"></i>
                  <span>Làm mới sau <span id="countdown" class="countdown">60</span>s</span>
               </div>
            </div>
         </header>

         <!-- Key Performance Indicators -->
         <div class="kpi-section">
            <div class="kpi-card">
               <i class="fas fa-users"></i>
               <div class="kpi-content">
                  <div class="kpi-title">Tổng số khách hàng</div>
                  <div id="totalCustomers" class="kpi-value">133</div>
               </div>
            </div>
            <div class="kpi-card">
               <i class="fas fa-check-circle"></i>
               <div class="kpi-content">
                  <div class="kpi-title">Tổng thành công</div>
                  <div id="totalSuccess" class="kpi-value">59</div>
               </div>
            </div>
            <div class="kpi-card">
               <i class="fas fa-percentage"></i>
               <div class="kpi-content">
                  <div class="kpi-title">Tỷ lệ thành công TB</div>
                  <div id="avgSuccessRate" class="kpi-value">44.4%</div>
               </div>
            </div>
            <div class="kpi-card">
               <i class="fas fa-building"></i>
               <div class="kpi-content">
                  <div class="kpi-title">Đã đến cơ sở</div>
                  <div id="totalArrivals" class="kpi-value">26</div>
               </div>
            </div>
         </div>

         <!-- Comparison Chart -->
         <div class="chart-section">
            <div class="section-title">
               <i class="fas fa-chart-bar"></i>
               <span>So sánh hiệu suất nhân viên</span>
            </div>
            <div id="comparisonChart" class="chart-container"></div>
         </div>

         <!-- Staff Cards - All 7 cards in one row -->
         <div class="section-title">
            <i class="fas fa-user-friends"></i>
            <span>Hiệu suất 7 nhân viên Telesales</span>
         </div>
         <div id="staffGrid" class="staff-grid">
            <!-- Staff cards will be generated here -->
         </div>
      </div>

      <!-- JavaScript for Chart and Dashboard functionality -->
      <script>
         // Biến toàn cục
         let staffData = [];
         let apiToken =
            "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjZmNGQ0NTk0NTk2Y2NjOGZjZGNjMDExIiwidG9rZW5fdHlwZSI6MCwicm9sZSI6IkFETUlOX1RFTEVTQUxFUyIsImlhdCI6MTc0NjI0MDczNywiZXhwIjoxODc1ODQwNzM3fQ.oeBg85DrrCYEQ5rXo-ubSM_98Zh9xeY_zuqb_4btNB4";
         let apiBaseUrl = "https://api.mediccare.vn";
         let countdownValue = 60;
         let countdownInterval;
         let showAwardTimer;
         let awardShown = false;

         // Tạo sao cho nền màn hình vinh danh
         function createStars() {
            const stars = document.getElementById("stars");
            stars.innerHTML = "";

            for (let i = 0; i < 150; i++) {
               const star = document.createElement("div");
               star.className = "star";

               // Vị trí ngẫu nhiên
               const top = Math.random() * 100;
               const left = Math.random() * 100;

               // Thời gian nhấp nháy và độ sáng ngẫu nhiên
               const startOpacity = Math.random() * 0.5 + 0.1;
               const endOpacity = Math.random() * 0.9 + 0.5;
               const duration = Math.random() * 3 + 2 + "s";

               star.style.top = `${top}%`;
               star.style.left = `${left}%`;
               star.style.setProperty("--start-opacity", startOpacity);
               star.style.setProperty("--end-opacity", endOpacity);
               star.style.setProperty("--opacity", startOpacity);
               star.style.setProperty("--duration", duration);

               stars.appendChild(star);
            }
         }

         // Tạo hiệu ứng confetti
         function createConfetti() {
            const awardScreen = document.getElementById("awardScreen");

            // Xóa confetti cũ
            const oldConfetti = document.querySelectorAll(".confetti");
            oldConfetti.forEach((el) => el.remove());

            const confettiCount = 100;
            const colors = ["#fbbf24", "#0ea5e9", "#10b981", "#f43f5e", "#8b5cf6", "#ec4899", "#14b8a6"];
            const shapes = ["square", "circle", "triangle"];

            for (let i = 0; i < confettiCount; i++) {
               const confetti = document.createElement("div");
               const shape = shapes[Math.floor(Math.random() * shapes.length)];
               confetti.className = `confetti ${shape}`;

               // Random vị trí
               const left = Math.random() * 100;

               // Random màu sắc
               const colorIndex = Math.floor(Math.random() * colors.length);

               // Random kích thước
               const size = Math.random() * 8 + 5;

               // Random tốc độ rơi
               const animationDuration = Math.random() * 4 + 2;

               // Random độ trễ bắt đầu
               const animationDelay = Math.random() * 3;

               confetti.style.left = `${left}%`;

               if (shape === "triangle") {
                  confetti.style.borderBottomColor = colors[colorIndex];
               } else {
                  confetti.style.backgroundColor = colors[colorIndex];
               }

               confetti.style.width = `${size}px`;
               confetti.style.height = `${size}px`;
               confetti.style.animationDuration = `${animationDuration}s`;
               confetti.style.animationDelay = `${animationDelay}s`;

               awardScreen.appendChild(confetti);
            }
         }

         // Hiển thị màn hình vinh danh
         function showAwardScreen(staffList) {
            if (awardShown) return;

            // Sort the staff list by success rate (highest first) before selecting top performers
            const sortedStaff = [...staffList].sort((a, b) => b.precents_customer_success - a.precents_customer_success);

            // Chỉ lấy top 2 nhân viên xuất sắc nhất
            if (sortedStaff.length >= 2) {
               const awardScreen = document.getElementById("awardScreen");
               const awardWinners = document.getElementById("awardWinners");
               awardWinners.innerHTML = "";

               // Cập nhật tháng/năm
               const now = new Date();
               const month = now.getMonth() + 1;
               const year = now.getFullYear();
               document.getElementById("awardMonth").textContent = `${month}/${year}`;

               // Nhân viên top 1
               const gold = sortedStaff[0];
               const goldAwardHtml = `
        <div class="award-item animate__animated animate__fadeInLeft">
              <div class="award-position position-gold">Top 1</div>
              <div class="award-photo-container">
                 <img src="https://fbads-megakorea.s3-hcm-r1.s3cloud.vn/0977cb0ece26181a3a89d058d.jpg" alt="Nhân viên xuất sắc" class="award-photo">
                <div class="award-badge badge-gold"></div>
              </div>
              <div class="star-rating">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
              </div>
            </div>`;

               // Nhân viên top 2
               const silver = sortedStaff[1];
               const silverAwardHtml = `
        <div class="award-item animate__animated animate__fadeInRight">
              <div class="award-position position-silver">Top 2</div>
              <div class="award-photo-container">
            
                   
                     <img src="https://fbads-megakorea.s3-hcm-r1.s3cloud.vn/0977cb0ece26181a3a89d058b.jpg" alt="Nhân viên xuất sắc" class="award-photo">
                <div class="award-badge badge-silver"></div>
              </div>
              <div class="star-rating">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star-half-alt"></i>
              </div>
            </div>`;

               awardWinners.innerHTML = goldAwardHtml + silverAwardHtml;

               // Tạo sao và confetti
               createStars();
               createConfetti();

               // Hiển thị màn hình vinh danh
               awardScreen.classList.add("active");
               awardShown = true;

               // Tự động ẩn sau 10 giây
               setTimeout(() => {
                  hideAwardScreen();
               }, 25000);
            }
         }

         // Ẩn màn hình vinh danh
         function hideAwardScreen() {
            const awardScreen = document.getElementById("awardScreen");
            awardScreen.classList.remove("active");
         }

         // Thiết lập hẹn giờ hiển thị màn hình vinh danh
         function setupAwardTimer() {
            // Xóa timer cũ nếu có
            if (showAwardTimer) {
               clearTimeout(showAwardTimer);
            }

            // Hiển thị sau 1 phút (60000ms)
            showAwardTimer = setTimeout(() => {
               showAwardScreen(staffData);
               awardShown = false; // Reset để lần sau có thể hiển thị lại
            }, 60000);
         }

         // Hiển thị ngày hiện tại
         function updateDateDisplay() {
            const now = new Date();
            const options = { day: "2-digit", month: "2-digit", year: "numeric" };
            const formattedDate = now.toLocaleDateString("vi-VN", options);
            document.getElementById("currentDate").textContent = `Ngày ${formattedDate}`;
         }

         // Định dạng ngày YYYY-MM-DD
         function formatDate(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, "0");
            const day = String(date.getDate()).padStart(2, "0");
            return `${year}-${month}-${day}`;
         }

         // Lấy dữ liệu từ API
         async function fetchData() {
            try {
               showLoading();

               // Định dạng ngày hiện tại YYYY-MM-DD
               const today = new Date();
               const formattedDate = formatDate(today);

               const response = await fetch(`${apiBaseUrl}/customers/analytics-customer-details-of-day?date=${formattedDate}`, {
                  method: "GET",
                  headers: {
                     Authorization: `Bearer ${apiToken}`,
                  },
               });

               if (!response.ok) {
                  throw new Error("Network response was not ok");
               }

               const data = await response.json();
               if (data.success) {
                  staffData = data.result;
                  renderDashboard(data);

                  // Thiết lập timer cho màn hình vinh danh
                  setupAwardTimer();

                  hideLoading();
               } else {
                  console.error("API returned error:", data.message);
                  hideLoading();
                  showError("Không thể lấy dữ liệu từ API");
               }
            } catch (error) {
               console.error("Không thể lấy dữ liệu:", error);
               hideLoading();
               showError("Không thể kết nối đến máy chủ");

               // Sử dụng dữ liệu mẫu khi không thể kết nối API
               useDemoData();
            }
         }

         // Dữ liệu mẫu khi không thể kết nối API
         function useDemoData() {
            const demoData = {
               success: true,
               result: [
                  {
                     telesales: "Trần",
                     total_customers: 14,
                     customers_success: 8,
                     customer_arrive: 1,
                     customer_not_contacted: 5,
                     precents_customer_success: 57.1,
                     precents_customer_arrive: 7.1,
                     precent_customer_not_contacted: 35.7,
                  },
                  {
                     telesales: "Tường Vy",
                     total_customers: 33,
                     customers_success: 18,
                     customer_arrive: 7,
                     customer_not_contacted: 9,
                     precents_customer_success: 54.5,
                     precents_customer_arrive: 21.2,
                     precent_customer_not_contacted: 27.3,
                  },
                  {
                     telesales: "Trinh",
                     total_customers: 13,
                     customers_success: 6,
                     customer_arrive: 1,
                     customer_not_contacted: 4,
                     precents_customer_success: 46.2,
                     precents_customer_arrive: 7.7,
                     precent_customer_not_contacted: 30.8,
                  },
                  {
                     telesales: "Thùy Linh",
                     total_customers: 22,
                     customers_success: 10,
                     customer_arrive: 5,
                     customer_not_contacted: 4,
                     precents_customer_success: 45.5,
                     precents_customer_arrive: 22.7,
                     precent_customer_not_contacted: 18.2,
                  },
                  {
                     telesales: "Thúy Vy",
                     total_customers: 19,
                     customers_success: 7,
                     customer_arrive: 5,
                     customer_not_contacted: 7,
                     precents_customer_success: 36.8,
                     precents_customer_arrive: 26.3,
                     precent_customer_not_contacted: 36.8,
                  },
                  {
                     telesales: "Ngọc",
                     total_customers: 25,
                     customers_success: 7,
                     customer_arrive: 5,
                     customer_not_contacted: 13,
                     precents_customer_success: 28.0,
                     precents_customer_arrive: 20.0,
                     precent_customer_not_contacted: 52.0,
                  },
                  {
                     telesales: "Thắm",
                     total_customers: 0,
                     customers_success: 0,
                     customer_arrive: 4,
                     customer_not_contacted: 0,
                     precents_customer_success: 0,
                     precents_customer_arrive: 0,
                     precent_customer_not_contacted: 0,
                  },
               ],
            };

            renderDashboard(demoData);

            // Thiết lập timer cho màn hình vinh danh với dữ liệu mẫu
            staffData = demoData.result;
            setupAwardTimer();
         }

         // Hiển thị dashboard
         function renderDashboard(data) {
            if (!data.success || !data.result || !Array.isArray(data.result)) {
               console.error("Dữ liệu không hợp lệ");
               return;
            }

            // Cập nhật ngày
            updateDateDisplay();

            // Sắp xếp nhân viên theo tỷ lệ thành công (từ cao xuống thấp)
            const sortedStaff = [...data.result].sort((a, b) => b.precents_customer_success - a.precents_customer_success);

            // Tạo thẻ cho tất cả nhân viên
            renderStaffGrid(sortedStaff);

            // Tạo biểu đồ so sánh
            createComparisonChart(sortedStaff);

            // Cập nhật tổng số liệu
            updateSummaryStats(sortedStaff);
         }

         // Tạo grid hiển thị tất cả nhân viên
         function renderStaffGrid(staffList) {
            const staffGrid = document.getElementById("staffGrid");
            staffGrid.innerHTML = ""; // Xóa nội dung cũ

            // Tạo thẻ nhân viên
            staffList.forEach((staff, index) => {
               const cardHtml = createStaffCard(staff, index);
               staffGrid.innerHTML += cardHtml;
            });
         }

         // Tạo thẻ cho nhân viên
         function createStaffCard(staff, index) {
            // Xác định màu avatar và hạng
            let avatarClass = "";
            let headerStyle = "";

            if (index === 0) {
               avatarClass = "gold";
               headerStyle = "background: var(--gradient-gold);";
            } else if (index === 1) {
               avatarClass = "silver";
               headerStyle = "background: var(--gradient-silver);";
            } else if (index === 2) {
               avatarClass = "bronze";
               headerStyle = "background: var(--gradient-bronze);";
            }

            // Lấy chữ cái đầu của tên nhân viên
            const initial = staff.telesales.charAt(0);

            return `
            <div class="staff-card">
               <div class="staff-header" style="${headerStyle}">
                  <div class="staff-avatar ${avatarClass}">${initial}</div>
                  <div class="staff-name">${staff.telesales}</div>
                  <div class="staff-rank">Top ${index + 1}</div>
               </div>
               <div class="staff-body">
                  <div class="staff-stats">
                     <div class="stat-item">
                        <div class="stat-value">${staff.total_customers}</div>
                        <div class="stat-label">Tổng KH</div>
                     </div>
                     <div class="stat-item">
                        <div class="stat-value">${staff.customers_success}</div>
                        <div class="stat-label">Thành công</div>
                     </div>
                     <div class="stat-item">
                        <div class="stat-value">${staff.customer_arrive}</div>
                        <div class="stat-label">Đã đến</div>
                     </div>
                  </div>

                  <div class="progress-section">
                     <div class="progress-title">
                        <div class="progress-label">
                           <span style="display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--success)"></span>
                           Thành công
                        </div>
                        <div class="progress-value">${staff.precents_customer_success.toFixed(1)}%</div>
                     </div>
                     <div class="progress-bar">
                        <div class="progress progress-success" style="width: ${staff.precents_customer_success}%"></div>
                     </div>
                  </div>

                  <div class="progress-section">
                     <div class="progress-title">
                        <div class="progress-label">
                           <span style="display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--secondary)"></span>
                           Đã đến
                        </div>
                        <div class="progress-value">${staff.precents_customer_arrive.toFixed(1)}%</div>
                     </div>
                     <div class="progress-bar">
                        <div class="progress progress-info" style="width: ${staff.precents_customer_arrive}%"></div>
                     </div>
                  </div>

                  <div class="progress-section">
                     <div class="progress-title">
                        <div class="progress-label">
                           <span style="display:inline-block;width:6px;height:6px;border-radius:50%;background:var(--warning)"></span>
                           Chưa liên hệ
                        </div>
                        <div class="progress-value">${staff.precent_customer_not_contacted.toFixed(1)}%</div>
                     </div>
                     <div class="progress-bar">
                        <div class="progress progress-warning" style="width: ${staff.precent_customer_not_contacted}%"></div>
                     </div>
                  </div>
               </div>
            </div>
            `;
         }

         // Tạo biểu đồ so sánh
         function createComparisonChart(staffList) {
            const options = {
               series: [
                  {
                     name: "Tỷ lệ thành công",
                     data: staffList.map((staff) => staff.precents_customer_success),
                  },
                  {
                     name: "Đã đến cơ sở",
                     data: staffList.map((staff) => staff.precents_customer_arrive),
                  },
                  {
                     name: "Chưa liên hệ",
                     data: staffList.map((staff) => staff.precent_customer_not_contacted),
                  },
               ],
               chart: {
                  type: "bar",
                  height: 200,
                  stacked: false,
                  toolbar: {
                     show: false,
                  },
               },
               plotOptions: {
                  bar: {
                     horizontal: false,
                     columnWidth: "60%",
                     borderRadius: 2,
                  },
               },
               dataLabels: {
                  enabled: false,
               },
               stroke: {
                  width: 1,
                  colors: ["transparent"],
               },
               xaxis: {
                  categories: staffList.map((staff) => staff.telesales),
                  axisBorder: {
                     show: false,
                  },
                  axisTicks: {
                     show: false,
                  },
                  labels: {
                     style: {
                        fontSize: "15px",
                        fontWeight: "bold",
                     },
                  },
               },
               yaxis: {
                  max: 100,
                  min: 0,
                  tickAmount: 10,
                  labels: {
                     formatter: function (val) {
                        return val.toFixed(0) + " %";
                     },
                     style: {
                        fontSize: "11px",
                     },
                  },
               },
               fill: {
                  opacity: 1,
               },
               tooltip: {
                  y: {
                     formatter: function (val) {
                        return val.toFixed(1) + "%";
                     },
                  },
               },
               colors: ["#10b981", "#0ea5e9", "#f59e0b"],
               legend: {
                  position: "top",
                  horizontalAlign: "left",
                  fontSize: "11px",
                  markers: {
                     width: 10,
                     height: 10,
                  },
               },
            };

            // Xóa biểu đồ cũ nếu có
            document.getElementById("comparisonChart").innerHTML = "";

            const chart = new ApexCharts(document.getElementById("comparisonChart"), options);
            chart.render();
         }

         // Cập nhật tổng số liệu
         function updateSummaryStats(staffList) {
            // Tính tổng các chỉ số
            const totalCustomers = staffList.reduce((acc, curr) => acc + curr.total_customers, 0);
            const totalSuccess = staffList.reduce((acc, curr) => acc + curr.customers_success, 0);
            const totalArrivals = staffList.reduce((acc, curr) => acc + curr.customer_arrive, 0);
            const avgSuccessRate = (totalSuccess / totalCustomers) * 100 || 0;

            // Hiển thị lên dashboard
            document.getElementById("totalCustomers").textContent = totalCustomers;
            document.getElementById("totalSuccess").textContent = totalSuccess;
            document.getElementById("totalArrivals").textContent = totalArrivals;
            document.getElementById("avgSuccessRate").textContent = avgSuccessRate.toFixed(1) + "%";
         }

         // Hiển thị loading
         function showLoading() {
            // Tạo overlay loading nếu chưa có
            if (!document.getElementById("loadingOverlay")) {
               const overlay = document.createElement("div");
               overlay.id = "loadingOverlay";
               overlay.className = "fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm flex items-center justify-center z-50";
               overlay.innerHTML = `
                  <div class="relative p-4">
                     <div class="w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin"></div>
                     <div class="mt-4 text-white font-medium">Đang tải dữ liệu...</div>
                  </div>
               `;
               document.body.appendChild(overlay);
            } else {
               document.getElementById("loadingOverlay").style.display = "flex";
            }
         }

         // Ẩn loading
         function hideLoading() {
            const overlay = document.getElementById("loadingOverlay");
            if (overlay) {
               overlay.style.display = "none";
            }
         }

         // Hiển thị thông báo lỗi
         function showError(message) {
            const errorDiv = document.createElement("div");
            errorDiv.className =
               "fixed top-4 left-1/2 transform -translate-x-1/2 px-4 py-2 bg-red-600 bg-opacity-90 text-white rounded-lg shadow-lg z-50 font-medium";
            errorDiv.innerHTML = `<i class="fas fa-exclamation-circle mr-2"></i>${message}`;

            document.body.appendChild(errorDiv);

            // Tự động ẩn thông báo sau 5 giây
            setTimeout(() => {
               errorDiv.style.opacity = "0";
               errorDiv.style.transition = "opacity 0.5s ease";
               setTimeout(() => {
                  errorDiv.remove();
               }, 500);
            }, 5000);
         }

         // Thiết lập đồng hồ đếm ngược
         function setupCountdown() {
            const countdownElement = document.getElementById("countdown");

            // Xóa interval cũ nếu có
            if (countdownInterval) {
               clearInterval(countdownInterval);
            }

            countdownValue = 60;
            countdownElement.textContent = countdownValue;

            countdownInterval = setInterval(() => {
               countdownValue--;
               if (countdownValue < 0) {
                  countdownValue = 60;
                  // Cập nhật dữ liệu khi hết thời gian đếm ngược
                  fetchData();
               }
               countdownElement.textContent = countdownValue;
            }, 1000);
         }

         // Khởi tạo dashboard khi tải trang
         document.addEventListener("DOMContentLoaded", function () {
            fetchData();
            setupCountdown();
            createStars(); // Tạo sao ngay từ đầu

            // Thêm nút để test màn hình vinh danh (tùy chọn, có thể bỏ trong production)
            // Thêm vào khi cần test
            /*
            const testButton = document.createElement('button');
            testButton.textContent = 'Test Vinh Danh';
            testButton.className = 'fixed bottom-4 right-4 bg-indigo-600 text-white px-4 py-2 rounded-lg shadow-lg';
            testButton.addEventListener('click', () => {
               if (staffData.length > 0) {
                  showAwardScreen(staffData);
                  awardShown = false; // Reset để có thể test nhiều lần
               }
            });
            document.body.appendChild(testButton);
            */
         });
      </script>
   </body>
</html>
