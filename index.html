<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Megakorea - Báo Cáo & Vinh Danh Telesales</title>

    <!-- Modern UI Libraries -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.40.0/apexcharts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particlesjs/2.2.3/particles.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap");

      :root {
        --primary: #4f46e5;
        --primary-dark: #4338ca;
        --secondary: #0ea5e9;
        --success: #10b981;
        --warning: #f59e0b;
        --danger: #ef4444;
        --light: #f8fafc;
        --dark: #1e293b;
        --gold: #ffc107;
        --silver: #94a3b8;
        --bronze: #b45309;
        --gradient-primary: linear-gradient(135deg, #4f46e5, #3b82f6);
        --gradient-secondary: linear-gradient(135deg, #0ea5e9, #06b6d4);
        --gradient-gold: linear-gradient(135deg, #fbbf24, #f59e0b);
        --gradient-silver: linear-gradient(135deg, #cbd5e1, #94a3b8);
        --gradient-bronze: linear-gradient(135deg, #d97706, #b45309);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Montserrat", sans-serif;
      }

      body {
        background-color: #f1f5f9;
        color: var(--dark);
        line-height: 1.6;
        overflow: hidden;
      }

      /* Custom scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }

      ::-webkit-scrollbar-track {
        background: rgba(203, 213, 225, 0.2);
        border-radius: 3px;
      }

      ::-webkit-scrollbar-thumb {
        background: rgba(100, 116, 139, 0.5);
        border-radius: 3px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: rgba(71, 85, 105, 0.7);
      }

      /* Glass morphism effect */
      .glass {
        background: rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.1);
        box-shadow: 0 8px 32px rgba(15, 23, 42, 0.1);
      }

      /* Pages navigation */
      .page-container {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        position: relative;
        background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
      }

      .page {
        position: absolute;
        width: 100%;
        height: 100%;
        transition: transform 0.8s cubic-bezier(0.16, 1, 0.3, 1);
      }

      .page.active {
        transform: translateX(0);
        z-index: 10;
      }

      .page.inactive-next {
        transform: translateX(100%);
        z-index: 5;
      }

      .page.inactive-prev {
        transform: translateX(-100%);
        z-index: 5;
      }

      .container {
        min-width: 100vw;
        height: 100%;
        padding: 1rem;
        display: flex;
        flex-direction: column;
      }

      /* Header styles */
      .dashboard-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: var(--gradient-primary);
        padding: 0.75rem 1.5rem;
        border-radius: 12px;
        color: white;
        box-shadow: 0 10px 25px -5px rgba(79, 70, 229, 0.3);
        margin-bottom: 1rem;
        height: 70px;
        position: relative;
        overflow: hidden;
      }

      .dashboard-header::before {
        content: "";
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        opacity: 0.5;
        animation: rotate 30s linear infinite;
      }

      @keyframes rotate {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }

      .dashboard-title {
        font-size: 1.25rem;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 0.75rem;
        position: relative;
        z-index: 1;
      }

      .dashboard-title i {
        font-size: 1.5rem;
      }

      .dashboard-logo {
        height: 40px;
        margin-right: 1rem;
      }

      .dashboard-info {
        display: flex;
        align-items: center;
        gap: 1.25rem;
        position: relative;
        z-index: 1;
      }

      .date-display {
        font-size: 0.875rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        background: rgba(255, 255, 255, 0.15);
        padding: 0.5rem 1rem;
        border-radius: 20px;
      }

      .refresh-info {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.875rem;
        background: rgba(255, 255, 255, 0.15);
        padding: 0.5rem 1rem;
        border-radius: 20px;
      }

      .page-indicator {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        background: rgba(255, 255, 255, 0.15);
        padding: 0.5rem 1rem;
        border-radius: 20px;
      }

      .page-dot {
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background-color: rgba(255, 255, 255, 0.5);
        transition: all 0.3s ease;
        cursor: pointer;
      }

      .page-dot.active {
        background-color: white;
        width: 20px;
        border-radius: 4px;
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
      }

      /* Dashboard content styles */
      .dashboard-content {
        display: flex;
        gap: 1rem;
        flex: 1;
        overflow: hidden;
      }

      /* Staff grid styles */
      .stats-section {
        width: 75%;
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
        overflow: hidden;
      }

      .top-employees-section {
        width: 25%;
        overflow: hidden;
      }

      .section-title {
        font-size: 1.125rem;
        font-weight: 600;
        margin-bottom: 0.75rem;
        color: var(--dark);
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding-left: 0.5rem;
        border-left: 4px solid var(--primary);
      }

      .section-title i {
        color: var(--primary);
      }

      .staff-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1rem;
        overflow-y: auto;
        padding: 0.5rem 0.25rem;
        max-height: calc(100vh - 160px);
      }

      .staff-card {
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05),
          0 2px 4px -1px rgba(0, 0, 0, 0.03);
        transition: all 0.3s ease;
        border: 1px solid #e2e8f0;
        display: flex;
        flex-direction: column;
        height: 550px;
        position: relative;
      }

      .staff-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.05),
          0 10px 10px -5px rgba(0, 0, 0, 0.02);
      }

      .staff-card::after {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 5px;
        background: var(--gradient-primary);
        transform: scaleX(0);
        transform-origin: left;
        transition: transform 0.3s ease;
      }

      .staff-card:hover::after {
        transform: scaleX(1);
      }

      .staff-header {
        padding: 1.25rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #e2e8f0;
        background: linear-gradient(to right, #f8fafc, white);
      }

      .staff-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
      }

      .staff-avatar {
        width: 48px;
        height: 48px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        font-size: 1.25rem;
        color: white;
        border-radius: 12px;
        background: var(--gradient-primary);
        box-shadow: 0 4px 6px -1px rgba(79, 70, 229, 0.3);
      }

      .staff-avatar.gold {
        background: var(--gradient-gold);
        box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.3);
      }

      .staff-avatar.silver {
        background: var(--gradient-silver);
        box-shadow: 0 4px 6px -1px rgba(148, 163, 184, 0.3);
      }

      .staff-avatar.bronze {
        background: var(--gradient-bronze);
        box-shadow: 0 4px 6px -1px rgba(180, 83, 9, 0.3);
      }

      .staff-name-container {
        display: flex;
        flex-direction: column;
      }

      .staff-name {
        font-size: 1rem;
        font-weight: 600;
        margin-bottom: 0.25rem;
      }

      .staff-role {
        font-size: 0.75rem;
        color: #64748b;
        display: flex;
        align-items: center;
        gap: 0.25rem;
      }

      .staff-rank {
        display: flex;
        align-items: center;
        gap: 0.375rem;
        font-weight: 600;
        font-size: 0.75rem;
        padding: 0.375rem 0.75rem;
        border-radius: 20px;
        color: white;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .staff-rank.gold {
        background: var(--gradient-gold);
      }

      .staff-rank.silver {
        background: var(--gradient-silver);
      }

      .staff-rank.bronze {
        background: var(--gradient-bronze);
      }

      .staff-rank.regular {
        background: linear-gradient(135deg, #64748b, #475569);
      }

      .staff-body {
        padding: 1.25rem;
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }

      .staff-stats {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 0.75rem;
      }

      .stat-item {
        text-align: center;
        padding: 0.5rem;
        border-radius: 8px;
        background-color: #f8fafc;
        border: 1px solid #e2e8f0;
        transition: all 0.3s ease;
      }

      .stat-item:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
      }

      .stat-value {
        font-size: 1.25rem;
        font-weight: 700;
        margin-bottom: 0.125rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }

      .stat-label {
        font-size: 0.6875rem;
        color: #64748b;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .progress-section {
        margin-bottom: 0.5rem;
      }

      .progress-title {
        display: flex;
        justify-content: space-between;
        margin-bottom: 0.5rem;
        font-size: 0.75rem;
        align-items: center;
      }

      .progress-label {
        font-weight: 500;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: flex;
        align-items: center;
        gap: 0.375rem;
      }

      .progress-value {
        font-weight: 700;
        white-space: nowrap;
        padding: 0.125rem 0.5rem;
        background-color: #f1f5f9;
        border-radius: 10px;
      }

      .performance-indicator {
        height: 8px;
        width: 8px;
        border-radius: 50%;
        display: inline-block;
      }

      .progress-bar {
        height: 8px;
        background-color: #e2e8f0;
        border-radius: 4px;
        overflow: hidden;
        position: relative;
      }

      .progress {
        height: 100%;
        border-radius: 4px;
        position: relative;
        transition: width 1s ease;
      }

      .progress::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          90deg,
          rgba(255, 255, 255, 0) 0%,
          rgba(255, 255, 255, 0.3) 50%,
          rgba(255, 255, 255, 0) 100%
        );
        animation: shine 2s infinite linear;
      }

      @keyframes shine {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(100%);
        }
      }

      .progress-success {
        background: var(--success);
      }

      .progress-warning {
        background: var(--warning);
      }

      .progress-info {
        background: var(--secondary);
      }

      .chart-container {
        height: 60px;
        margin-top: 0.5rem;
      }

      .performance-status {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-weight: 600;
        font-size: 0.75rem;
        margin-top: auto;
        padding: 0.5rem;
        border-radius: 8px;
      }

      .status-high {
        color: var(--success);
        background-color: rgba(16, 185, 129, 0.1);
      }

      .status-medium {
        color: var(--warning);
        background-color: rgba(245, 158, 11, 0.1);
      }

      .status-low {
        color: var(--danger);
        background-color: rgba(239, 68, 68, 0.1);
      }

      .status-icon {
        font-size: 0.875rem;
      }

      /* Top employees section */
      .top-employees-container {
        background-color: white;
        border-radius: 12px;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05),
          0 2px 4px -1px rgba(0, 0, 0, 0.03);
        border: 1px solid #e2e8f0;
        height: calc(100vh - 160px);
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .top-header {
        padding: 1rem;
        background: var(--gradient-primary);
        color: white;
        text-align: center;
        font-weight: 600;
        font-size: 1.125rem;
        position: relative;
        overflow: hidden;
      }

      .top-header::before {
        content: "";
        position: absolute;
        top: -100%;
        left: -100%;
        width: 300%;
        height: 300%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.2) 0%,
          transparent 60%
        );
        animation: pulse-header 8s infinite;
      }

      @keyframes pulse-header {
        0% {
          opacity: 0.5;
          transform: translate(0, 0);
        }
        50% {
          opacity: 0.8;
          transform: translate(-10%, -10%);
        }
        100% {
          opacity: 0.5;
          transform: translate(0, 0);
        }
      }

      .top-body {
        flex: 1;
        display: flex;
        flex-direction: column;
        padding: 1rem;
        gap: 1rem;
        overflow-y: auto;
      }

      .top-employee-card {
        display: flex;
        background-color: #f8fafc;
        border-radius: 12px;
        padding: 1rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        transition: all 0.3s ease;
        position: relative;
        overflow: hidden;
        border: 1px solid #e2e8f0;
      }

      .top-employee-card:hover {
        transform: translateY(-5px) scale(1.02);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
      }

      .top-employee-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.2) 0%,
          rgba(255, 255, 255, 0) 60%
        );
      }

      .top-employee-card.gold {
        background: linear-gradient(135deg, #fffbeb, #fef3c7);
        border: 1px solid #fbbf24;
      }

      .top-employee-card.silver {
        background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
        border: 1px solid #94a3b8;
      }

      .top-employee-card.bronze {
        background: linear-gradient(135deg, #ffedd5, #fed7aa);
        border: 1px solid #d97706;
      }

      .top-employee-card::after {
        content: "";
        position: absolute;
        top: -20px;
        right: -20px;
        width: 40px;
        height: 40px;
        background: white;
        transform: rotate(45deg);
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }

      .top-employee-card.gold::after {
        background-color: #fbbf24;
      }

      .top-employee-card.silver::after {
        background-color: #94a3b8;
      }

      .top-employee-card.bronze::after {
        background-color: #d97706;
      }

      .top-employee-rank {
        min-width: 42px;
        height: 42px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 12px;
        font-weight: 700;
        font-size: 1.125rem;
        margin-right: 1rem;
        color: white;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        position: relative;
        z-index: 2;
      }

      .top-employee-rank.rank-1 {
        background: var(--gradient-gold);
      }

      .top-employee-rank.rank-2 {
        background: var(--gradient-silver);
      }

      .top-employee-rank.rank-3 {
        background: var(--gradient-bronze);
      }

      .top-employee-details {
        flex: 1;
        position: relative;
        z-index: 2;
      }

      .top-employee-name {
        font-weight: 600;
        font-size: 1rem;
        margin-bottom: 0.5rem;
      }

      .top-employee-stats {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 0.75rem;
      }

      .top-stat {
        font-size: 0.75rem;
        background-color: rgba(255, 255, 255, 0.6);
        padding: 0.375rem 0.75rem;
        border-radius: 8px;
        display: flex;
        align-items: center;
        gap: 0.375rem;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
      }

      .top-stat i {
        color: var(--primary);
      }

      .top-employee-progress {
        margin-top: 0.5rem;
      }

      /* Award Page Styles */
      .award-page {
        background: radial-gradient(
          ellipse at bottom,
          #1b2735 0%,
          #090a0f 100%
        );
        color: white;
        overflow: hidden;
      }

      #stars {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 0;
      }

      .award-container {
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        padding: 2rem;
        position: relative;
        z-index: 10;
      }

      .award-header {
        text-align: center;
        margin-bottom: 3rem;
        position: relative;
        animation: fadeInDown 1s;
      }

      .award-title {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 0.75rem;
        text-shadow: 0 0 20px rgba(79, 70, 229, 0.5);
        background: linear-gradient(to right, #fff, #93c5fd);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        position: relative;
      }

      .award-title::after {
        content: "";
        position: absolute;
        width: 100px;
        height: 5px;
        background: linear-gradient(to right, #4f46e5, transparent);
        bottom: -10px;
        left: 50%;
        transform: translateX(-50%);
        border-radius: 3px;
      }

      .award-subtitle {
        font-size: 1.5rem;
        color: #93c5fd;
        margin-bottom: 1rem;
        text-shadow: 0 0 10px rgba(147, 197, 253, 0.5);
      }

      .award-date {
        font-size: 1rem;
        color: #cbd5e1;
      }

      .award-content {
        display: flex;
        justify-content: center;
        align-items: center;
        flex: 1;
        gap: 4rem;
        max-width: 1200px;
        margin: 0 auto;
      }

      .award-item {
        text-align: center;
        position: relative;
        transition: all 0.5s ease;
        animation: floatAnimation 4s ease-in-out infinite;
      }

      @keyframes floatAnimation {
        0% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-15px);
        }
        100% {
          transform: translateY(0);
        }
      }

      .award-item:nth-child(2) {
        animation-delay: 1s;
      }

      .award-photo-container {
        position: relative;
        width: 320px;
        height: 420px;
        margin-bottom: 2rem;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        transform: perspective(1000px) rotateY(0deg);
        transition: transform 0.5s ease;
      }

      .award-photo-container:hover {
        transform: perspective(1000px) rotateY(5deg);
      }

      .award-photo {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: all 0.5s ease;
      }

      .award-photo-container:hover .award-photo {
        transform: scale(1.05);
      }

      .award-photo-container::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          to bottom,
          rgba(0, 0, 0, 0.1) 0%,
          rgba(0, 0, 0, 0.3) 70%,
          rgba(0, 0, 0, 0.7) 100%
        );
        z-index: 1;
      }

      .award-photo-container::after {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 50%;
        height: 100%;
        background: linear-gradient(
          to right,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transform: skewX(-25deg);
        animation: shine 6s infinite;
      }

      @keyframes shine {
        0% {
          left: -100%;
        }
        20%,
        100% {
          left: 100%;
        }
      }

      .award-badge {
        position: absolute;
        top: -30px;
        right: -30px;
        width: 140px;
        height: 140px;
        z-index: 2;
      }

      .badge-gold {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'%3E%3Ccircle cx='70' cy='70' r='65' fill='%23FFCA28' stroke='%23FFA000' stroke-width='3'/%3E%3Ctext x='70' y='75' font-family='Arial' font-size='24' font-weight='bold' text-anchor='middle' fill='%23B71C1C'%3ETOP 1%3C/text%3E%3Cpath d='M70 15 L75 30 L90 30 L80 40 L85 55 L70 45 L55 55 L60 40 L50 30 L65 30 Z' fill='%23FFD54F'/%3E%3C/svg%3E");
      }

      .badge-silver {
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='140' height='140' viewBox='0 0 140 140'%3E%3Ccircle cx='70' cy='70' r='65' fill='%23E0E0E0' stroke='%23BDBDBD' stroke-width='3'/%3E%3Ctext x='70' y='75' font-family='Arial' font-size='24' font-weight='bold' text-anchor='middle' fill='%23424242'%3ETOP 2%3C/text%3E%3Cpath d='M70 15 L75 30 L90 30 L80 40 L85 55 L70 45 L55 55 L60 40 L50 30 L65 30 Z' fill='%23F5F5F5'/%3E%3C/svg%3E");
      }

      .award-employee-name {
        font-size: 1.75rem;
        font-weight: 700;
        color: white;
        position: absolute;
        bottom: 50px;
        left: 0;
        width: 100%;
        text-align: center;
        z-index: 3;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.8);
      }

      .award-stats {
        font-size: 1.375rem;
        color: #93c5fd;
        margin-bottom: 0.75rem;
        text-shadow: 0 0 10px rgba(147, 197, 253, 0.5);
        position: relative;
        display: inline-block;
      }

      .award-stats::after {
        content: "";
        position: absolute;
        bottom: -5px;
        left: 50%;
        transform: translateX(-50%);
        width: 50px;
        height: 3px;
        background: rgba(147, 197, 253, 0.5);
        border-radius: 3px;
      }

      .award-position {
        display: inline-block;
        font-size: 1.75rem;
        font-weight: 700;
        padding: 0.75rem 2rem;
        border-radius: 50px;
        margin-bottom: 1.5rem;
        position: relative;
        z-index: 1;
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
      }

      .position-gold {
        background: var(--gradient-gold);
        color: #7c2d12;
      }

      .position-silver {
        background: var(--gradient-silver);
        color: #1f2937;
      }

      .star-rating {
        margin-top: 0.75rem;
        color: #fbbf24;
        font-size: 1.75rem;
        filter: drop-shadow(0 0 5px rgba(251, 191, 36, 0.5));
      }

      /* Confetti Animation */
      .confetti {
        position: absolute;
        width: 10px;
        height: 10px;
        border-radius: 0;
        animation: confetti-fall 5s ease-in-out infinite;
        z-index: 1;
      }

      .confetti.square {
        border-radius: 0;
      }

      .confetti.circle {
        border-radius: 50%;
      }

      .confetti.triangle {
        width: 0;
        height: 0;
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
        border-bottom: 15px solid;
        background-color: transparent !important;
      }

      @keyframes confetti-fall {
        0% {
          transform: translateY(-100vh) rotate(0deg);
          opacity: 1;
        }
        100% {
          transform: translateY(100vh) rotate(720deg);
          opacity: 0;
        }
      }

      /* Loading indicator */
      .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(15, 23, 42, 0.7);
        backdrop-filter: blur(5px);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .spinner-container {
        position: relative;
        width: 100px;
        height: 100px;
      }

      .spinner {
        width: 80px;
        height: 80px;
        border: 4px solid rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        border-top-color: var(--primary);
        animation: spin 1s ease-in-out infinite;
        position: absolute;
        top: 10px;
        left: 10px;
      }

      .spinner::before {
        content: "";
        position: absolute;
        top: -4px;
        left: -4px;
        right: -4px;
        bottom: -4px;
        border: 4px solid transparent;
        border-top-color: var(--secondary);
        border-radius: 50%;
        animation: spin 2s linear infinite;
      }

      .spinner-text {
        position: absolute;
        bottom: -30px;
        left: 0;
        width: 100%;
        text-align: center;
        color: white;
        font-size: 0.875rem;
        font-weight: 500;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      /* Animation classes */
      .animation-pulse {
        animation: pulse 2s infinite;
      }

      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }

      .data-update-animation {
        animation: flash-update 1s;
      }

      @keyframes flash-update {
        0% {
          background-color: rgba(16, 185, 129, 0);
        }
        50% {
          background-color: rgba(16, 185, 129, 0.2);
        }
        100% {
          background-color: rgba(16, 185, 129, 0);
        }
      }

      /* Make the layout more compact for smaller screens */
      @media (max-height: 800px) {
        .dashboard-header {
          height: 60px;
          padding: 0.5rem 1rem;
          margin-bottom: 0.5rem;
        }

        .staff-card {
          height: 280px;
        }

        .top-employee-card {
          padding: 0.75rem;
        }

        .section-title {
          margin-bottom: 0.5rem;
        }

        .award-title {
          font-size: 2.5rem;
        }

        .award-subtitle {
          font-size: 1.25rem;
        }

        .award-photo-container {
          width: 280px;
          height: 380px;
        }
      }

      /* Achievement badge animation */
      .achievement-badge {
        position: absolute;
        top: 10px;
        right: 10px;
        width: 30px;
        height: 30px;
        background: var(--gradient-primary);
        border-radius: 50%;
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        opacity: 0;
        transform: scale(0);
        animation: badge-pop 0.5s forwards;
        animation-delay: 0.5s;
        z-index: 10;
      }

      @keyframes badge-pop {
        0% {
          opacity: 0;
          transform: scale(0);
        }
        70% {
          opacity: 1;
          transform: scale(1.2);
        }
        100% {
          opacity: 1;
          transform: scale(1);
        }
      }
    </style>
  </head>
  <body>
    <div class="page-container">
      <!-- Trang báo cáo telesales -->
      <div class="page active" id="reportPage">
        <div class="container">
          <header class="dashboard-header">
            <div class="dashboard-title">
              <i class="fas fa-chart-line"></i>
              <div>
                <h1>Megakorea - Báo Cáo Telesales</h1>
              </div>
            </div>
            <div class="dashboard-info">
              <div class="date-display">
                <i class="far fa-calendar-alt"></i>
                <span id="currentDate">Ngày 03/05/2025</span>
              </div>
              <div class="refresh-info">
                <i class="fas fa-sync-alt animation-pulse"></i>
                <span
                  >Làm mới sau
                  <span id="countdown" class="countdown">60</span>s</span
                >
              </div>
              <div class="page-indicator">
                <span class="page-dot active" data-page="0"></span>
                <span class="page-dot" data-page="1"></span>
              </div>
            </div>
          </header>

          <div class="dashboard-content">
            <!-- Phần thống kê nhân viên (3/4 bên trái) -->
            <div class="stats-section">
              <div class="section-title">
                <i class="fas fa-users"></i>
                <span>Hiệu suất nhân viên Telesales</span>
              </div>
              <div id="staffGrid" class="staff-grid">
                <!-- Dữ liệu nhân viên sẽ được điền ở đây bằng JavaScript -->
              </div>
            </div>

            <!-- Phần top 3 nhân viên (1/4 bên phải) -->
            <div class="top-employees-section">
              <div class="section-title">
                <i class="fas fa-trophy"></i>
                <span>Top 3 nhân viên xuất sắc</span>
              </div>
              <div class="top-employees-container">
                <div class="top-header">
                  <i class="fas fa-crown" style="margin-right: 8px"></i>
                  Bảng xếp hạng thành tích
                </div>
                <div id="topEmployees" class="top-body">
                  <!-- Top 3 nhân viên sẽ được điền ở đây bằng JavaScript -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Trang vinh danh -->
      <div class="page inactive-next award-page" id="awardPage">
        <div id="stars"></div>
        <div class="award-container">
          <div class="award-header animate__animated animate__fadeIn">
            <h1 class="award-title">VINH DANH NHÂN VIÊN XUẤT SẮC</h1>
            <p class="award-subtitle">Telesales xuất sắc nhất tháng 4/2025</p>
            <p class="award-date" id="awardDate">
              Megakorea vinh danh những đóng góp xuất sắc
            </p>
          </div>

          <div class="award-content" id="awardContent">
            <!-- Nội dung vinh danh sẽ được điền ở đây bằng JavaScript -->
          </div>
        </div>
      </div>

      <!-- Loading overlay -->
      <div class="loading-overlay" id="loadingOverlay" style="display: none">
        <div class="spinner-container">
          <div class="spinner"></div>
          <div class="spinner-text">Đang tải dữ liệu...</div>
        </div>
      </div>
    </div>

    <script>
      // Biến toàn cục
      let activePageIndex = 0;
      let countdownValue = 60;
      let pageRotationInterval;
      let countdownInterval;
      let apiToken =
        "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoiNjZmNGQ0NTk0NTk2Y2NjOGZjZGNjMDExIiwidG9rZW5fdHlwZSI6MCwicm9sZSI6IkFETUlOX1RFTEVTQUxFUyIsImlhdCI6MTc0NjI0MDczNywiZXhwIjoxODc1ODQwNzM3fQ.oeBg85DrrCYEQ5rXo-ubSM_98Zh9xeY_zuqb_4btNB4";
      let apiBaseUrl = "https://api.mediccare.vn";
      let staffData = [];
      let pageRotationTime = 30000 * 4; // 30 giây mỗi trang
      let dataRefreshTime = 60000; // 1 phút làm mới dữ liệu

      // Khởi tạo hiệu ứng sao
      function initStars() {
        const starsContainer = document.getElementById("stars");
        if (!starsContainer) return;

        starsContainer.innerHTML = "";

        // Tạo 200 ngôi sao với các kích thước và tốc độ khác nhau
        for (let i = 0; i < 200; i++) {
          const star = document.createElement("div");
          const size = Math.random() * 2 + 1;

          star.style.position = "absolute";
          star.style.width = `${size}px`;
          star.style.height = `${size}px`;
          star.style.borderRadius = "50%";
          star.style.backgroundColor = "white";
          star.style.opacity = Math.random() * 0.8 + 0.2;
          star.style.left = `${Math.random() * 100}%`;
          star.style.top = `${Math.random() * 100}%`;
          star.style.animation = `twinkle ${
            Math.random() * 3 + 2
          }s infinite alternate`;

          starsContainer.appendChild(star);
        }
      }

      // Hiệu ứng nhấp nháy cho các ngôi sao
      const twinkleStyle = document.createElement("style");
      twinkleStyle.textContent = `
        @keyframes twinkle {
          0% { opacity: 0.2; }
          100% { opacity: 1; }
        }
      `;
      document.head.appendChild(twinkleStyle);

      // Lấy dữ liệu từ API
      async function fetchData() {
        try {
          showLoading();

          // Định dạng ngày hiện tại YYYY-MM-DD
          const today = new Date();
          const formattedDate = formatDate(today);

          const response = await fetch(
            `${apiBaseUrl}/customers/analytics-customer-details-of-day?date=${formattedDate}`,
            {
              method: "GET",
              headers: {
                Authorization: `Bearer ${apiToken}`,
              },
            }
          );

          if (!response.ok) {
            throw new Error("Network response was not ok");
          }

          const data = await response.json();
          if (data.success) {
            staffData = data.result;
            renderDashboard(data);
            hideLoading();
          } else {
            console.error("API returned error:", data.message);
            hideLoading();
            showError("Không thể lấy dữ liệu từ API");
          }
        } catch (error) {
          console.error("Không thể lấy dữ liệu:", error);
          hideLoading();
          showError("Không thể kết nối đến máy chủ");

          // Sử dụng dữ liệu mẫu khi không thể kết nối API
          useDemoData();
        }
      }

      // Dữ liệu mẫu khi không thể kết nối API
      function useDemoData() {
        const demoData = {
          success: true,
          result: [
            {
              telesales: "Nguyễn Thị Hương",
              total_customers: 148,
              customers_success: 62,
              customer_arrive: 45,
              customer_not_contacted: 30,
              precents_customer_success: 41.89,
              precents_customer_arrive: 30.41,
              precent_customer_not_contacted: 20.27,
            },
            {
              telesales: "Trần Văn Minh",
              total_customers: 135,
              customers_success: 54,
              customer_arrive: 42,
              customer_not_contacted: 25,
              precents_customer_success: 40.0,
              precents_customer_arrive: 31.11,
              precent_customer_not_contacted: 18.52,
            },
            {
              telesales: "Lê Thị Anh",
              total_customers: 124,
              customers_success: 45,
              customer_arrive: 36,
              customer_not_contacted: 28,
              precents_customer_success: 36.29,
              precents_customer_arrive: 29.03,
              precent_customer_not_contacted: 22.58,
            },
            {
              telesales: "Phạm Văn Nam",
              total_customers: 115,
              customers_success: 38,
              customer_arrive: 30,
              customer_not_contacted: 24,
              precents_customer_success: 33.04,
              precents_customer_arrive: 26.09,
              precent_customer_not_contacted: 20.87,
            },
            {
              telesales: "Hoàng Thị Mai",
              total_customers: 108,
              customers_success: 35,
              customer_arrive: 28,
              customer_not_contacted: 20,
              precents_customer_success: 32.41,
              precents_customer_arrive: 25.93,
              precent_customer_not_contacted: 18.52,
            },
            {
              telesales: "Đỗ Văn Tuấn",
              total_customers: 102,
              customers_success: 32,
              customer_arrive: 25,
              customer_not_contacted: 22,
              precents_customer_success: 31.37,
              precents_customer_arrive: 24.51,
              precent_customer_not_contacted: 21.57,
            },
            {
              telesales: "Ngô Thị Lan",
              total_customers: 95,
              customers_success: 29,
              customer_arrive: 24,
              customer_not_contacted: 18,
              precents_customer_success: 30.53,
              precents_customer_arrive: 25.26,
              precent_customer_not_contacted: 18.95,
            },
            {
              telesales: "Vũ Văn Hùng",
              total_customers: 90,
              customers_success: 26,
              customer_arrive: 21,
              customer_not_contacted: 15,
              precents_customer_success: 28.89,
              precents_customer_arrive: 23.33,
              precent_customer_not_contacted: 16.67,
            },
          ],
        };

        renderDashboard(demoData);
      }

      // Hiển thị dashboard
      function renderDashboard(data) {
        if (!data.success || !data.result || !Array.isArray(data.result)) {
          console.error("Dữ liệu không hợp lệ");
          return;
        }

        // Cập nhật ngày
        updateDateDisplay();

        // Sắp xếp nhân viên theo tỷ lệ thành công (từ cao xuống thấp)
        const sortedStaff = [...data.result].sort(
          (a, b) => b.precents_customer_success - a.precents_customer_success
        );

        // Tạo thẻ cho tất cả nhân viên
        renderStaffGrid(sortedStaff);

        // Hiển thị top 3 nhân viên
        renderTopEmployees(sortedStaff.slice(0, 3));

        // Tạo trang vinh danh
        renderAwardPage(sortedStaff.slice(0, 2));

        // Khởi tạo hiệu ứng sao cho trang vinh danh
        initStars();

        // Hiệu ứng cập nhật dữ liệu
        animateDataUpdate();
      }

      // Tạo grid hiển thị tất cả nhân viên
      function renderStaffGrid(staffList) {
        const staffGrid = document.getElementById("staffGrid");
        staffGrid.innerHTML = ""; // Xóa nội dung cũ

        // Tạo thẻ nhân viên với hiệu ứng xuất hiện tuần tự
        staffList.forEach((staff, index) => {
          const cardHtml = createStaffCard(staff, index);

          // Thêm thẻ vào DOM
          const cardElement = document.createElement("div");
          cardElement.innerHTML = cardHtml.html;
          const actualCard = cardElement.firstElementChild;

          // Thêm hiệu ứng xuất hiện tuần tự
          actualCard.style.opacity = "0";
          actualCard.style.transform = "translateY(20px)";
          actualCard.style.transition =
            "opacity 0.5s ease, transform 0.5s ease";

          staffGrid.appendChild(actualCard);

          // Kích hoạt hiệu ứng xuất hiện sau một khoảng thời gian
          setTimeout(() => {
            actualCard.style.opacity = "1";
            actualCard.style.transform = "translateY(0)";
          }, index * 100);
        });

        // Tạo các biểu đồ mini sau khi HTML đã được tạo
        setTimeout(() => {
          staffList.forEach((staff, index) => {
            const chartId = `chart-${staff.telesales
              .replace(/\s+/g, "-")
              .toLowerCase()}`;
            createMiniChart(chartId, staff);
          });
        }, 300);
      }

      // Hiển thị top 3 nhân viên
      function renderTopEmployees(topStaff) {
        const topContainer = document.getElementById("topEmployees");
        topContainer.innerHTML = ""; // Xóa nội dung cũ

        // Tạo thẻ cho top 3 nhân viên với hiệu ứng xuất hiện tuần tự
        topStaff.forEach((staff, index) => {
          const rankClass =
            index === 0 ? "gold" : index === 1 ? "silver" : "bronze";
          const html = createTopEmployeeCard(staff, index + 1, rankClass);

          // Thêm thẻ vào DOM
          const cardElement = document.createElement("div");
          cardElement.innerHTML = html;
          const actualCard = cardElement.firstElementChild;

          // Thêm hiệu ứng xuất hiện tuần tự
          actualCard.style.opacity = "0";
          actualCard.style.transform = "translateX(20px)";
          actualCard.style.transition =
            "opacity 0.5s ease, transform 0.5s ease";

          topContainer.appendChild(actualCard);

          // Kích hoạt hiệu ứng xuất hiện sau một khoảng thời gian
          setTimeout(() => {
            actualCard.style.opacity = "1";
            actualCard.style.transform = "translateX(0)";

            // Thêm huy hiệu thành tích với hiệu ứng xuất hiện
            if (index === 0) {
              const badge = document.createElement("div");
              badge.className = "achievement-badge";
              badge.innerHTML = '<i class="fas fa-star"></i>';
              actualCard.appendChild(badge);
            }
          }, index * 200 + 300);
        });
      }

      // Tạo trang vinh danh
      function renderAwardPage(topStaff) {
        const awardContent = document.getElementById("awardContent");
        awardContent.innerHTML = ""; // Xóa nội dung cũ

        // Chỉ lấy top 2 nhân viên xuất sắc nhất
        if (topStaff.length >= 2) {
          // Nhân viên top 1
          const gold = topStaff[0];
          const goldAwardHtml = `
            <div class="award-item animate__animated animate__fadeInLeft">
              <div class="award-position position-gold">Top 1</div>
              <div class="award-photo-container">
                <img src="https://megakorea.vn/wp-content/uploads/2025/05/Best-Telesale-T4.png" alt="Nhân viên xuất sắc" class="award-photo" onerror="this.src='/api/placeholder/320/420'">
                <div class="award-badge badge-gold"></div>
               
              </div>
              <div class="award-stats">
               
              </div>
              <div class="star-rating">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
              </div>
            </div>
          `;

          // Nhân viên top 2
          const silver = topStaff[1];
          const silverAwardHtml = `
            <div class="award-item animate__animated animate__fadeInRight">
              <div class="award-position position-silver">Top 2</div>
              <div class="award-photo-container">
                <img src="https://megakorea.vn/wp-content/uploads/2025/05/Best-Telesale-T4-1.png" alt="Nhân viên xuất sắc" class="award-photo" onerror="this.src='/api/placeholder/320/420'">
                <div class="award-badge badge-silver"></div>
                
              </div>
              <div class="award-stats">
                
              </div>
              <div class="star-rating">
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star"></i>
                <i class="fas fa-star-half-alt"></i>
              </div>
            </div>
          `;

          awardContent.innerHTML = goldAwardHtml + silverAwardHtml;

          // Thêm hiệu ứng confetti
          createConfetti();
        }
      }

      // Tạo thẻ nhân viên
      function createStaffCard(staff, index) {
        // Xác định màu hiệu suất và trạng thái
        let performanceStatus = "low";
        let performanceText = "Cần cải thiện";
        let performanceIcon = "fa-arrow-down";

        if (staff.precents_customer_success >= 40) {
          performanceStatus = "high";
          performanceText = "Xuất sắc";
          performanceIcon = "fa-arrow-up";
        } else if (staff.precents_customer_success >= 25) {
          performanceStatus = "medium";
          performanceText = "Khá tốt";
          performanceIcon = "fa-arrow-right";
        }

        // Xác định hạng
        let rankClass = "regular";
        let rankText = `Top ${index + 1}`;
        let avatarClass = "";

        if (index === 0) {
          rankClass = "gold";
          avatarClass = "gold";
          rankText = "Top 1";
        } else if (index === 1) {
          rankClass = "silver";
          avatarClass = "silver";
          rankText = "Top 2";
        } else if (index === 2) {
          rankClass = "bronze";
          avatarClass = "bronze";
          rankText = "Top 3";
        }

        // Lấy chữ cái đầu của tên nhân viên
        const initial = staff.telesales.charAt(0);

        // Tạo ID duy nhất cho biểu đồ
        const chartId = `chart-${staff.telesales
          .replace(/\s+/g, "-")
          .toLowerCase()}`;

        // Tạo HTML cho thẻ nhân viên
        const cardHtml = `
          <div class="staff-card">
            <div class="staff-header">
              <div class="staff-info">
                <div class="staff-avatar ${avatarClass}">${initial}</div>
                <div class="staff-name-container">
                  <div class="staff-name">${staff.telesales}</div>
                  <div class="staff-role">
                    <i class="fas fa-headset" style="color: var(--primary); margin-right: 4px;"></i>
                    Telesales
                  </div>
                </div>
              </div>
              <div class="staff-rank ${rankClass}">
                <i class="fas fa-trophy"></i>
                <span>${rankText}</span>
              </div>
            </div>
            <div class="staff-body">
              <div class="staff-stats">
                <div class="stat-item">
                  <div class="stat-value">${staff.total_customers}</div>
                  <div class="stat-label">Tổng KH</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value">${staff.customers_success}</div>
                  <div class="stat-label">Thành công</div>
                </div>
                <div class="stat-item">
                  <div class="stat-value">${staff.customer_arrive}</div>
                  <div class="stat-label">Đã đến</div>
                </div>
              </div>

              <div class="progress-section">
                <div class="progress-title">
                  <div class="progress-label">
                    <span class="performance-indicator" style="background-color: var(--success);"></span>
                    Tỷ lệ thành công
                  </div>
                  <div class="progress-value">${staff.precents_customer_success.toFixed(
                    1
                  )}%</div>
                </div>
                <div class="progress-bar">
                  <div class="progress progress-success" style="width: ${
                    staff.precents_customer_success
                  }%"></div>
                </div>
              </div>

              <div class="progress-section">
                <div class="progress-title">
                  <div class="progress-label">
                    <span class="performance-indicator" style="background-color: var(--secondary);"></span>
                    Đã đến cơ sở
                  </div>
                  <div class="progress-value">${staff.precents_customer_arrive.toFixed(
                    1
                  )}%</div>
                </div>
                <div class="progress-bar">
                  <div class="progress progress-info" style="width: ${
                    staff.precents_customer_arrive
                  }%"></div>
                </div>
              </div>

              <div class="progress-section">
                <div class="progress-title">
                  <div class="progress-label">
                    <span class="performance-indicator" style="background-color: var(--warning);"></span>
                    Chưa liên hệ
                  </div>
                  <div class="progress-value">${staff.precent_customer_not_contacted.toFixed(
                    1
                  )}%</div>
                </div>
                <div class="progress-bar">
                  <div class="progress progress-warning" style="width: ${
                    staff.precent_customer_not_contacted
                  }%"></div>
                </div>
              </div>

              <div class="chart-container" id="${chartId}"></div>

              <div class="performance-status status-${performanceStatus}">
                <i class="fas ${performanceIcon} status-icon"></i>
                <span>Hiệu suất: ${performanceText}</span>
              </div>
            </div>
          </div>
        `;

        return { html: cardHtml, chartId: chartId };
      }

      // Tạo thẻ cho top nhân viên
      function createTopEmployeeCard(staff, rank, rankClass) {
        return `
          <div class="top-employee-card ${rankClass}">
            <div class="top-employee-rank rank-${rank}">${rank}</div>
            <div class="top-employee-details">
              <div class="top-employee-name">${staff.telesales}</div>
              <div class="top-employee-stats">
                <div class="top-stat">
                  <i class="fas fa-users"></i>
                  <span>${staff.total_customers} KH</span>
                </div>
                <div class="top-stat">
                  <i class="fas fa-check-circle"></i>
                  <span>${staff.customers_success} thành công</span>
                </div>
              </div>
              <div class="top-employee-progress">
                <div class="progress-title">
                  <div class="progress-label">Tỷ lệ thành công</div>
                  <div class="progress-value">${staff.precents_customer_success.toFixed(
                    1
                  )}%</div>
                </div>
                <div class="progress-bar">
                  <div class="progress progress-success" style="width: ${
                    staff.precents_customer_success
                  }%"></div>
                </div>
              </div>
            </div>
          </div>
        `;
      }

      // Tạo biểu đồ mini
      function createMiniChart(containerId, staffData) {
        const options = {
          series: [
            {
              name: "Thành công",
              data: [staffData.precents_customer_success],
            },
            {
              name: "Đã đến",
              data: [staffData.precents_customer_arrive],
            },
            {
              name: "Chưa liên hệ",
              data: [staffData.precent_customer_not_contacted],
            },
          ],
          chart: {
            type: "bar",
            height: 60,
            stacked: true,
            toolbar: {
              show: false,
            },
            sparkline: {
              enabled: true,
            },
            animations: {
              enabled: true,
              speed: 500,
              animateGradually: {
                enabled: true,
                delay: 150,
              },
              dynamicAnimation: {
                enabled: true,
                speed: 350,
              },
            },
          },
          plotOptions: {
            bar: {
              horizontal: true,
              borderRadius: 4,
              columnWidth: "70%",
              distributed: false,
            },
          },
          colors: ["#10b981", "#0ea5e9", "#f59e0b"],
          dataLabels: {
            enabled: false,
          },
          stroke: {
            width: 1,
            colors: ["#fff"],
          },
          grid: {
            show: false,
          },
          xaxis: {
            labels: {
              show: false,
            },
            axisBorder: {
              show: false,
            },
            axisTicks: {
              show: false,
            },
          },
          yaxis: {
            show: false,
          },
          tooltip: {
            enabled: true,
            shared: true,
            intersect: false,
            custom: function ({ seriesIndex, dataPointIndex, w }) {
              const seriesName = w.globals.seriesNames[seriesIndex];
              const value = w.globals.series[seriesIndex][dataPointIndex];
              return `<div class="apexcharts-tooltip-title" style="font-family: 'Montserrat', sans-serif; font-size: 12px; padding: 5px 8px; background: #f8fafc; font-weight: 600;">${seriesName}: ${value.toFixed(
                1
              )}%</div>`;
            },
          },
          legend: {
            show: false,
          },
        };

        try {
          const chartElement = document.getElementById(containerId);
          if (chartElement) {
            const chart = new ApexCharts(chartElement, options);
            chart.render();
          }
        } catch (error) {
          console.error("Lỗi khi tạo biểu đồ:", error);
        }
      }

      // Tạo hiệu ứng confetti
      function createConfetti() {
        // Xóa confetti cũ
        const oldConfetti = document.querySelectorAll(".confetti");
        oldConfetti.forEach((el) => el.remove());

        const confettiCount = 150;
        const colors = [
          "#fbbf24",
          "#0ea5e9",
          "#10b981",
          "#f43f5e",
          "#8b5cf6",
          "#ec4899",
          "#14b8a6",
        ];
        const shapes = ["square", "circle", "triangle"];

        for (let i = 0; i < confettiCount; i++) {
          const confetti = document.createElement("div");
          const shape = shapes[Math.floor(Math.random() * shapes.length)];
          confetti.className = `confetti ${shape}`;

          // Random vị trí
          const left = Math.random() * 100;

          // Random màu sắc
          const colorIndex = Math.floor(Math.random() * colors.length);

          // Random kích thước
          const size = Math.random() * 10 + 5;

          // Random tốc độ rơi
          const animationDuration = Math.random() * 4 + 2;

          // Random độ trễ bắt đầu
          const animationDelay = Math.random() * 5;

          confetti.style.left = `${left}%`;

          if (shape === "triangle") {
            confetti.style.borderBottomColor = colors[colorIndex];
          } else {
            confetti.style.backgroundColor = colors[colorIndex];
          }

          confetti.style.width = `${size}px`;
          confetti.style.height = `${size}px`;
          confetti.style.animationDuration = `${animationDuration}s`;
          confetti.style.animationDelay = `${animationDelay}s`;

          document.getElementById("awardPage").appendChild(confetti);
        }
      }

      // Hiệu ứng khi cập nhật dữ liệu
      function animateDataUpdate() {
        const cards = document.querySelectorAll(
          ".staff-card, .top-employee-card"
        );
        cards.forEach((card) => {
          card.classList.add("data-update-animation");
          setTimeout(() => {
            card.classList.remove("data-update-animation");
          }, 1000);
        });
      }

      // Cập nhật hiển thị ngày hiện tại
      function updateDateDisplay() {
        const now = new Date();
        const options = { day: "2-digit", month: "2-digit", year: "numeric" };
        const formattedDate = now.toLocaleDateString("vi-VN", options);

        document.getElementById(
          "currentDate"
        ).textContent = `Ngày ${formattedDate}`;

        // Cập nhật ngày trên trang vinh danh
        const month = now.getMonth() + 1;
        const year = now.getFullYear();
        // document.getElementById(
        //   "awardDate"
        // ).textContent = `Megakorea vinh danh những đóng góp xuất sắc - Tháng ${month}/${year}`;
      }

      // Đổi trang hiển thị
      function switchPage() {
        const pages = document.querySelectorAll(".page");
        const dots = document.querySelectorAll(".page-dot");

        // Lưu lại trang hiện tại
        const currentPageIndex = activePageIndex;

        // Cập nhật chỉ số trang mới
        activePageIndex = (activePageIndex + 1) % pages.length;

        // Cập nhật trạng thái trang
        pages.forEach((page, index) => {
          if (index === activePageIndex) {
            // Trang mới active
            page.className = "page active";
            if (index === 1) {
              page.classList.add("award-page");
            }
          } else {
            // Trang không active
            if (index < activePageIndex) {
              page.className = "page inactive-prev";
            } else {
              page.className = "page inactive-next";
            }

            if (index === 1) {
              page.classList.add("award-page");
            }
          }
        });

        // Cập nhật chỉ báo trang
        dots.forEach((dot, index) => {
          if (index === activePageIndex) {
            dot.classList.add("active");
          } else {
            dot.classList.remove("active");
          }
        });

        // Tạo lại confetti nếu chuyển sang trang vinh danh
        if (activePageIndex === 1) {
          setTimeout(() => {
            createConfetti();
          }, 500);
        }
      }

      // Cập nhật đồng hồ đếm ngược
      function updateCountdown() {
        document.getElementById("countdown").textContent = countdownValue;
        countdownValue--;

        if (countdownValue < 0) {
          countdownValue = 60;
          refreshData();
        }
      }

      // Làm mới dữ liệu
      function refreshData() {
        fetchData();
      }

      // Định dạng ngày YYYY-MM-DD
      function formatDate(date) {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, "0");
        const day = String(date.getDate()).padStart(2, "0");
        return `${year}-${month}-${day}`;
      }

      // Hiển thị loading
      function showLoading() {
        document.getElementById("loadingOverlay").style.display = "flex";
      }

      // Ẩn loading
      function hideLoading() {
        document.getElementById("loadingOverlay").style.display = "none";
      }

      // Hiển thị thông báo lỗi
      function showError(message) {
        const errorDiv = document.createElement("div");
        errorDiv.style.position = "fixed";
        errorDiv.style.top = "20px";
        errorDiv.style.left = "50%";
        errorDiv.style.transform = "translateX(-50%)";
        errorDiv.style.padding = "10px 20px";
        errorDiv.style.backgroundColor = "rgba(239, 68, 68, 0.9)";
        errorDiv.style.color = "white";
        errorDiv.style.borderRadius = "8px";
        errorDiv.style.boxShadow =
          "0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05)";
        errorDiv.style.zIndex = "2000";
        errorDiv.style.fontWeight = "500";
        errorDiv.innerHTML = `<i class="fas fa-exclamation-circle" style="margin-right: 8px;"></i>${message}`;

        document.body.appendChild(errorDiv);

        // Tự động ẩn thông báo sau 5 giây
        setTimeout(() => {
          errorDiv.style.opacity = "0";
          errorDiv.style.transition = "opacity 0.5s ease";
          setTimeout(() => {
            errorDiv.remove();
          }, 500);
        }, 5000);
      }

      // Khởi động ứng dụng
      document.addEventListener("DOMContentLoaded", function () {
        // Lấy dữ liệu ban đầu
        fetchData();

        // Bắt đầu đếm ngược
        countdownInterval = setInterval(updateCountdown, 30000);

        // Bắt đầu chuyển trang tự động
        pageRotationInterval = setInterval(switchPage, pageRotationTime);

        // Bắt đầu làm mới dữ liệu tự động
        setInterval(refreshData, dataRefreshTime);

        // Thêm xử lý sự kiện click vào chỉ báo trang
        const dots = document.querySelectorAll(".page-dot");
        dots.forEach((dot, index) => {
          dot.addEventListener("click", function () {
            if (index !== activePageIndex) {
              // Dừng tự động chuyển trang
              clearInterval(pageRotationInterval);

              // Chuyển đến trang được chọn
              activePageIndex = index === 0 ? 1 : 0; // Đặt trước trang đối diện để switchPage() sẽ chuyển về trang chính xác
              switchPage();

              // Khởi động lại tự động chuyển trang
              pageRotationInterval = setInterval(switchPage, pageRotationTime);
            }
          });
        });

        // Theo dõi kích thước cửa sổ và điều chỉnh kích thước phần tử
        window.addEventListener("resize", function () {
          // Thêm mã xử lý điều chỉnh kích thước nếu cần
        });
      });
    </script>
  </body>
</html>
